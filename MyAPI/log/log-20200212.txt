2020-02-12 13:14:12.738 +08:00 [DBG] 程序启动
2020-02-12 13:14:13.808 +08:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-02-12 13:14:14.142 +08:00 [INF] Now listening on: http://localhost:5000
2020-02-12 13:14:14.143 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2020-02-12 13:14:14.145 +08:00 [INF] Hosting environment: Development
2020-02-12 13:14:14.146 +08:00 [INF] Content root path: E:\SandTablePriject\.net core3.1\MyAPI\MyAPI
2020-02-12 14:33:39.185 +08:00 [INF] Application is shutting down...
2020-02-12 14:46:42.695 +08:00 [DBG] 程序启动
2020-02-12 14:46:43.054 +08:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-02-12 14:46:43.270 +08:00 [INF] Now listening on: http://localhost:5000
2020-02-12 14:46:43.272 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2020-02-12 14:46:43.273 +08:00 [INF] Hosting environment: Development
2020-02-12 14:46:43.274 +08:00 [INF] Content root path: E:\SandTablePriject\.net core3.1\MyAPI\MyAPI
2020-02-12 15:37:29.445 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=24bc829f-70a4-4faf-97ba-d78d792f699c  
2020-02-12 15:37:31.734 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=24bc829f-70a4-4faf-97ba-d78d792f699c  
2020-02-12 15:37:35.121 +08:00 [INF] Successfully validated the token.
2020-02-12 15:37:35.121 +08:00 [INF] Successfully validated the token.
2020-02-12 15:37:35.129 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 15:37:35.130 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:37:35.203 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 15:37:35.203 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 15:37:36.785 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 15:37:36.785 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 15:37:37.694 +08:00 [INF] Executed DbCommand (133ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 15:37:37.694 +08:00 [INF] Executed DbCommand (135ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 15:37:37.818 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 15:37:37.818 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 15:37:37.857 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 2643.6087ms
2020-02-12 15:37:37.857 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 2641.7626ms
2020-02-12 15:37:37.868 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:37:37.868 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 15:37:37.877 +08:00 [INF] Request finished in 6144.0354ms 200 application/json; charset=utf-8
2020-02-12 15:37:37.877 +08:00 [INF] Request finished in 8438.3037ms 200 application/json; charset=utf-8
2020-02-12 15:37:38.169 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=24bc829f-70a4-4faf-97ba-d78d792f699c  
2020-02-12 15:37:38.170 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=24bc829f-70a4-4faf-97ba-d78d792f699c  
2020-02-12 15:37:38.179 +08:00 [INF] Successfully validated the token.
2020-02-12 15:37:38.180 +08:00 [INF] Successfully validated the token.
2020-02-12 15:37:38.182 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:37:38.185 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 15:37:38.187 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 15:37:38.198 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 15:37:38.268 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 15:37:38.268 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 15:37:38.285 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 15:37:38.285 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 15:37:38.291 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 15:37:38.296 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 15:37:38.299 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 96.9979ms
2020-02-12 15:37:38.302 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 110.3713ms
2020-02-12 15:37:38.305 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 15:37:38.308 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:37:38.310 +08:00 [INF] Request finished in 140.4272ms 200 application/json; charset=utf-8
2020-02-12 15:37:38.313 +08:00 [INF] Request finished in 143.4733ms 200 application/json; charset=utf-8
2020-02-12 15:49:11.834 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 15:49:11.842 +08:00 [INF] Successfully validated the token.
2020-02-12 15:49:11.846 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:49:11.852 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 15:49:11.861 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 15:49:11.881 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 15:49:12.009 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 15:49:12.025 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 170.1809ms
2020-02-12 15:49:12.028 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:49:12.033 +08:00 [INF] Request finished in 198.8098ms 200 application/json; charset=utf-8
2020-02-12 15:49:16.245 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 15:49:16.255 +08:00 [INF] Successfully validated the token.
2020-02-12 15:49:16.257 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:49:16.259 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 15:49:16.270 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 15:49:16.280 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 15:49:16.288 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 15:49:16.291 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 24.5927ms
2020-02-12 15:49:16.296 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 15:49:16.302 +08:00 [INF] Request finished in 58.4684ms 200 application/json; charset=utf-8
2020-02-12 16:02:23.100 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:02:23.145 +08:00 [INF] Successfully validated the token.
2020-02-12 16:02:23.146 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:23.148 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:02:23.156 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:02:23.180 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 16:02:23.229 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:02:23.238 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 83.8001ms
2020-02-12 16:02:23.241 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:23.243 +08:00 [INF] Request finished in 152.7609ms 200 application/json; charset=utf-8
2020-02-12 16:02:25.266 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting/9  
2020-02-12 16:02:25.271 +08:00 [INF] Successfully validated the token.
2020-02-12 16:02:25.272 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:25.282 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:02:25.297 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:02:25.330 +08:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
INNER JOIN [AspNetUsers] AS [a] ON [u].[UserId] = [a].[Id]
WHERE [u].[Id] = @__id_0
2020-02-12 16:02:25.379 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.User_MeetingOutputDto'.
2020-02-12 16:02:25.384 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 95.7265ms
2020-02-12 16:02:25.388 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:25.390 +08:00 [INF] Request finished in 124.3989ms 200 application/json; charset=utf-8
2020-02-12 16:02:28.287 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:02:28.299 +08:00 [INF] Successfully validated the token.
2020-02-12 16:02:28.304 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:28.306 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:02:28.313 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:02:28.337 +08:00 [INF] Executed DbCommand (16ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 16:02:28.354 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:02:28.359 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 49.0402ms
2020-02-12 16:02:28.362 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:28.365 +08:00 [INF] Request finished in 78.435ms 200 application/json; charset=utf-8
2020-02-12 16:02:29.643 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting/10  
2020-02-12 16:02:29.647 +08:00 [INF] Successfully validated the token.
2020-02-12 16:02:29.648 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:29.650 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:02:29.657 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:02:29.674 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
INNER JOIN [AspNetUsers] AS [a] ON [u].[UserId] = [a].[Id]
WHERE [u].[Id] = @__id_0
2020-02-12 16:02:29.681 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.User_MeetingOutputDto'.
2020-02-12 16:02:29.683 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 28.7831ms
2020-02-12 16:02:29.687 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:29.690 +08:00 [INF] Request finished in 47.041ms 200 application/json; charset=utf-8
2020-02-12 16:02:31.387 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:02:31.393 +08:00 [INF] Successfully validated the token.
2020-02-12 16:02:31.394 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:31.396 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:02:31.403 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:02:31.417 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 16:02:31.431 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:02:31.435 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 35.3587ms
2020-02-12 16:02:31.445 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:02:31.448 +08:00 [INF] Request finished in 61.0722ms 200 application/json; charset=utf-8
2020-02-12 16:02:32.048 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:02:32.056 +08:00 [INF] Successfully validated the token.
2020-02-12 16:02:32.057 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:02:32.058 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:02:32.065 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:02:32.079 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 16:02:32.096 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:02:32.107 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 46.012ms
2020-02-12 16:02:32.121 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:02:32.130 +08:00 [INF] Request finished in 82.183ms 200 application/json; charset=utf-8
2020-02-12 16:06:21.321 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting/29  
2020-02-12 16:06:21.342 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2020-02-12 16:06:21.690 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
2020-02-12 16:06:21.692 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:06:21.700 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:06:21.710 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:06:21.724 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__meetingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[Id] = @__meetingId_0
2020-02-12 16:06:21.741 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__userId_0
2020-02-12 16:06:21.757 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.MeetingOutputDto'.
2020-02-12 16:06:21.761 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 57.8102ms
2020-02-12 16:06:21.765 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:06:21.771 +08:00 [INF] Request finished in 449.632ms 200 application/json; charset=utf-8
2020-02-12 16:06:22.190 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/Meeting/29/createInviteCode application/json 2
2020-02-12 16:06:22.195 +08:00 [INF] CORS policy execution failed.
2020-02-12 16:06:22.197 +08:00 [INF] Request origin http://localhost:4200 does not have permission to access the resource.
2020-02-12 16:06:22.203 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2020-02-12 16:06:22.211 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
2020-02-12 16:06:22.212 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Post (MyAPI)'
2020-02-12 16:06:22.227 +08:00 [INF] Route matched with {action = "Post", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Int32) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:06:22.236 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:06:22.241 +08:00 [INF] Executed DbCommand (1ms) [Parameters=[@__meetingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[Id] = @__meetingId_0
2020-02-12 16:06:22.427 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@p7='?' (DbType = Int32), @p0='?' (Size = 4000), @p1='?' (Size = 4000), @p2='?' (DbType = DateTime2), @p3='?' (Size = 4000), @p4='?' (Size = 4000), @p5='?' (DbType = Int32), @p6='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
UPDATE [Meeting] SET [Address] = @p0, [Content] = @p1, [DateTime] = @p2, [InviteCode] = @p3, [MeetingName] = @p4, [MeetingStats] = @p5, [UserId] = @p6
WHERE [Id] = @p7;
SELECT @@ROWCOUNT;
2020-02-12 16:06:22.458 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.MeetingOutputDto'.
2020-02-12 16:06:22.461 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Post (MyAPI) in 228.9178ms
2020-02-12 16:06:22.462 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Post (MyAPI)'
2020-02-12 16:06:22.465 +08:00 [INF] Request finished in 275.2207ms 200 application/json; charset=utf-8
2020-02-12 16:06:28.141 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting/analysisInviteCode?inviteCode=PxvKzaGHYYzoCsH2Icd%252Bvbx6uatgdxzDykz7GpihW7w%253D  
2020-02-12 16:06:28.145 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2020-02-12 16:06:28.150 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
2020-02-12 16:06:28.153 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI)'
2020-02-12 16:06:28.163 +08:00 [INF] Route matched with {action = "AnalysisInviteCode", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AnalysisInviteCode(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:06:28.183 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:06:28.192 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__meetingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[Id] = @__meetingId_0
2020-02-12 16:06:28.197 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.MeetingOutputDto'.
2020-02-12 16:06:28.200 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI) in 31.1768ms
2020-02-12 16:06:28.206 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI)'
2020-02-12 16:06:28.208 +08:00 [INF] Request finished in 67.6366ms 200 application/json; charset=utf-8
2020-02-12 16:06:37.422 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/User_Meeting application/json 135
2020-02-12 16:06:37.425 +08:00 [INF] CORS policy execution failed.
2020-02-12 16:06:37.427 +08:00 [INF] Request origin http://localhost:4200 does not have permission to access the resource.
2020-02-12 16:06:37.433 +08:00 [INF] Failed to validate the token.
Microsoft.IdentityModel.Tokens.SecurityTokenExpiredException: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
   at Microsoft.IdentityModel.Tokens.Validators.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, SecurityToken securityToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateLifetime(Nullable`1 notBefore, Nullable`1 expires, JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateTokenPayload(JwtSecurityToken jwtToken, TokenValidationParameters validationParameters)
   at System.IdentityModel.Tokens.Jwt.JwtSecurityTokenHandler.ValidateToken(String token, TokenValidationParameters validationParameters, SecurityToken& validatedToken)
   at Microsoft.AspNetCore.Authentication.JwtBearer.JwtBearerHandler.HandleAuthenticateAsync()
2020-02-12 16:06:37.442 +08:00 [INF] Bearer was not authenticated. Failure message: IDX10223: Lifetime validation failed. The token is expired. ValidTo: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]', Current time: '[PII is hidden. For more details, see https://aka.ms/IdentityModel/PII.]'.
2020-02-12 16:06:37.444 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:06:37.462 +08:00 [INF] Route matched with {action = "Post", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Infrastructure.Dto.User_MeetingInputDto) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:06:37.493 +08:00 [DBG] 开始添加一条中间表信息
2020-02-12 16:06:37.499 +08:00 [DBG] 判断是否存在此条记录
2020-02-12 16:06:37.503 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:06:37.532 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [User_Meeting] AS [u]
        WHERE CAST(0 AS bit) = CAST(1 AS bit)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2020-02-12 16:06:37.538 +08:00 [DBG] 添加了一条参会记录数据
2020-02-12 16:06:37.593 +08:00 [ERR] Failed executing DbCommand (15ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 450), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [User_Meeting] ([MeetingId], [UserId], [User_MeetingStats])
VALUES (@p0, @p1, @p2);
SELECT [Id]
FROM [User_Meeting]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2020-02-12 16:06:37.719 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:200d2805-12d0-4eaa-b600-28fbd64631e6
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:200d2805-12d0-4eaa-b600-28fbd64631e6
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-02-12 16:06:37.747 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Post (MyAPI) in 276.5948ms
2020-02-12 16:06:37.751 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:06:37.754 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:200d2805-12d0-4eaa-b600-28fbd64631e6
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Data.UnitOfWork.save() in E:\SandTablePriject\.net core3.1\MyAPI\Infrastructure\Data\UnitOfWork.cs:line 18
   at MyAPI.Controllers.User_MeetingController.Post(User_MeetingInputDto inputDto) in E:\SandTablePriject\.net core3.1\MyAPI\MyAPI\Controllers\User_MeetingController.cs:line 96
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-02-12 16:06:37.844 +08:00 [INF] Request finished in 422.6778ms 500 text/plain
2020-02-12 16:07:30.379 +08:00 [INF] Application is shutting down...
2020-02-12 16:08:47.418 +08:00 [DBG] 程序启动
2020-02-12 16:08:54.138 +08:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-02-12 16:08:55.046 +08:00 [INF] Now listening on: http://localhost:5000
2020-02-12 16:08:55.053 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2020-02-12 16:08:55.054 +08:00 [INF] Hosting environment: Development
2020-02-12 16:08:55.055 +08:00 [INF] Content root path: E:\SandTablePriject\.net core3.1\MyAPI\MyAPI
2020-02-12 16:09:32.179 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:09:33.250 +08:00 [INF] Successfully validated the token.
2020-02-12 16:09:33.257 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:09:33.308 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:09:34.735 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:09:34.748 +08:00 [INF] Successfully validated the token.
2020-02-12 16:09:34.769 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:09:34.794 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:09:35.571 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:09:35.571 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:09:36.782 +08:00 [INF] Executed DbCommand (128ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 16:09:36.782 +08:00 [INF] Executed DbCommand (128ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 16:09:37.081 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:09:37.081 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:09:37.138 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 2334.0057ms
2020-02-12 16:09:37.139 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 3818.6207ms
2020-02-12 16:09:37.181 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:09:37.199 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:09:37.207 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:09:37.215 +08:00 [INF] Successfully validated the token.
2020-02-12 16:09:37.218 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:09:37.222 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:09:37.235 +08:00 [INF] Request finished in 5064.3431ms 200 application/json; charset=utf-8
2020-02-12 16:09:37.246 +08:00 [INF] Request finished in 2511.2636ms 200 application/json; charset=utf-8
2020-02-12 16:09:37.323 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:09:37.347 +08:00 [INF] Executed DbCommand (13ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 16:09:37.354 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:09:37.359 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 132.2179ms
2020-02-12 16:09:37.361 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:09:37.365 +08:00 [INF] Request finished in 184.5108ms 200 application/json; charset=utf-8
2020-02-12 16:09:45.773 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting/29  
2020-02-12 16:09:45.781 +08:00 [INF] Successfully validated the token.
2020-02-12 16:09:45.783 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:09:45.797 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:09:45.822 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:09:45.847 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__meetingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[Id] = @__meetingId_0
2020-02-12 16:09:45.866 +08:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [AspNetUsers] AS [a]
WHERE [a].[Id] = @__userId_0
2020-02-12 16:09:45.931 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.MeetingOutputDto'.
2020-02-12 16:09:45.934 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 129.0363ms
2020-02-12 16:09:45.941 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:09:45.944 +08:00 [INF] Request finished in 172.9659ms 200 application/json; charset=utf-8
2020-02-12 16:09:52.384 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting/analysisInviteCode?inviteCode=PxvKzaGHYYzoCsH2Icd%252Bvbx6uatgdxzDykz7GpihW7w%253D  
2020-02-12 16:09:52.392 +08:00 [INF] Successfully validated the token.
2020-02-12 16:09:52.394 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI)'
2020-02-12 16:09:52.408 +08:00 [INF] Route matched with {action = "AnalysisInviteCode", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AnalysisInviteCode(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:09:52.460 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:09:52.471 +08:00 [INF] Executed DbCommand (6ms) [Parameters=[@__meetingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[Id] = @__meetingId_0
2020-02-12 16:09:52.498 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.MeetingOutputDto'.
2020-02-12 16:09:52.505 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI) in 92.3931ms
2020-02-12 16:09:52.517 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI)'
2020-02-12 16:09:52.522 +08:00 [INF] Request finished in 137.7767ms 200 application/json; charset=utf-8
2020-02-12 16:09:54.564 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/User_Meeting application/json 135
2020-02-12 16:09:54.579 +08:00 [INF] CORS policy execution failed.
2020-02-12 16:09:54.581 +08:00 [INF] Request origin http://localhost:4200 does not have permission to access the resource.
2020-02-12 16:09:54.591 +08:00 [INF] Successfully validated the token.
2020-02-12 16:09:54.593 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:09:54.610 +08:00 [INF] Route matched with {action = "Post", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Infrastructure.Dto.User_MeetingInputDto) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:10:06.150 +08:00 [DBG] 开始添加一条中间表信息
2020-02-12 16:10:58.861 +08:00 [DBG] 判断是否存在此条记录
2020-02-12 16:10:58.865 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:10:58.899 +08:00 [INF] Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [User_Meeting] AS [u]
        WHERE CAST(0 AS bit) = CAST(1 AS bit)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2020-02-12 16:11:10.177 +08:00 [DBG] 添加了一条参会记录数据
2020-02-12 16:11:12.029 +08:00 [ERR] Failed executing DbCommand (54ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 450), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [User_Meeting] ([MeetingId], [UserId], [User_MeetingStats])
VALUES (@p0, @p1, @p2);
SELECT [Id]
FROM [User_Meeting]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2020-02-12 16:11:12.190 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:ed2c033c-403b-4603-af7d-cdc0cf5e9e09
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:ed2c033c-403b-4603-af7d-cdc0cf5e9e09
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-02-12 16:11:12.581 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Post (MyAPI) in 77963.9434ms
2020-02-12 16:11:12.584 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:11:12.587 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:ed2c033c-403b-4603-af7d-cdc0cf5e9e09
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Data.UnitOfWork.save() in E:\SandTablePriject\.net core3.1\MyAPI\Infrastructure\Data\UnitOfWork.cs:line 18
   at MyAPI.Controllers.User_MeetingController.Post(User_MeetingInputDto inputDto) in E:\SandTablePriject\.net core3.1\MyAPI\MyAPI\Controllers\User_MeetingController.cs:line 96
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-02-12 16:11:12.739 +08:00 [INF] Request finished in 78174.9457ms 500 text/plain
2020-02-12 16:13:32.475 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting/analysisInviteCode?inviteCode=PxvKzaGHYYzoCsH2Icd%252Bvbx6uatgdxzDykz7GpihW7w%253D  
2020-02-12 16:13:32.483 +08:00 [INF] Successfully validated the token.
2020-02-12 16:13:32.486 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI)'
2020-02-12 16:13:32.489 +08:00 [INF] Route matched with {action = "AnalysisInviteCode", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] AnalysisInviteCode(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:13:32.496 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:13:32.511 +08:00 [INF] Executed DbCommand (10ms) [Parameters=[@__meetingId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[Id] = @__meetingId_0
2020-02-12 16:13:32.520 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.MeetingOutputDto'.
2020-02-12 16:13:32.526 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI) in 32.7823ms
2020-02-12 16:13:32.531 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.AnalysisInviteCode (MyAPI)'
2020-02-12 16:13:32.533 +08:00 [INF] Request finished in 58.6419ms 200 application/json; charset=utf-8
2020-02-12 16:13:41.195 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/User_Meeting application/json 135
2020-02-12 16:13:41.199 +08:00 [INF] CORS policy execution failed.
2020-02-12 16:13:41.200 +08:00 [INF] Request origin http://localhost:4200 does not have permission to access the resource.
2020-02-12 16:13:41.209 +08:00 [INF] Successfully validated the token.
2020-02-12 16:13:41.211 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:13:41.215 +08:00 [INF] Route matched with {action = "Post", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Infrastructure.Dto.User_MeetingInputDto) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:14:13.133 +08:00 [DBG] 开始添加一条中间表信息
2020-02-12 16:14:54.494 +08:00 [DBG] 判断是否存在此条记录
2020-02-12 16:14:57.803 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:14:57.811 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [User_Meeting] AS [u]
        WHERE CAST(0 AS bit) = CAST(1 AS bit)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2020-02-12 16:15:37.557 +08:00 [DBG] 添加了一条参会记录数据
2020-02-12 16:15:37.575 +08:00 [ERR] Failed executing DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 450), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [User_Meeting] ([MeetingId], [UserId], [User_MeetingStats])
VALUES (@p0, @p1, @p2);
SELECT [Id]
FROM [User_Meeting]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2020-02-12 16:15:37.584 +08:00 [ERR] An exception occurred in the database while saving changes for context type 'Infrastructure.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:568be1c4-0b90-472f-adc1-207396dac460
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:568be1c4-0b90-472f-adc1-207396dac460
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2020-02-12 16:15:37.853 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Post (MyAPI) in 116627.689ms
2020-02-12 16:15:37.855 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:15:37.858 +08:00 [ERR] An unhandled exception has occurred while executing the request.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while updating the entries. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): 不能将值 NULL 插入列 'UserId'，表 'graduation.dbo.User_Meeting'；列不允许有 Null 值。INSERT 失败。
语句已终止。
   at Microsoft.Data.SqlClient.SqlCommand.<>c.<ExecuteDbDataReaderAsync>b__164_0(Task`1 result)
   at System.Threading.Tasks.ContinuationResultTaskFromResultTask`2.InnerInvoke()
   at System.Threading.Tasks.Task.<>c.<.cctor>b__274_0(Object obj)
   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)
--- End of stack trace from previous location where exception was thrown ---
   at System.Threading.Tasks.Task.ExecuteWithThreadLocal(Task& currentTaskSlot, Thread threadPoolThread)
--- End of stack trace from previous location where exception was thrown ---
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReaderAsync(RelationalCommandParameterObject parameterObject, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
ClientConnectionId:568be1c4-0b90-472f-adc1-207396dac460
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(DbContext _, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Data.UnitOfWork.save() in E:\SandTablePriject\.net core3.1\MyAPI\Infrastructure\Data\UnitOfWork.cs:line 18
   at MyAPI.Controllers.User_MeetingController.Post(User_MeetingInputDto inputDto) in E:\SandTablePriject\.net core3.1\MyAPI\MyAPI\Controllers\User_MeetingController.cs:line 96
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|19_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
2020-02-12 16:15:37.896 +08:00 [INF] Request finished in 116701.6369ms 500 text/plain
2020-02-12 16:20:11.208 +08:00 [DBG] 程序启动
2020-02-12 16:20:13.271 +08:00 [INF] User profile is available. Using 'C:\Users\Administrator\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
2020-02-12 16:20:13.916 +08:00 [INF] Now listening on: http://localhost:5000
2020-02-12 16:20:13.918 +08:00 [INF] Application started. Press Ctrl+C to shut down.
2020-02-12 16:20:13.918 +08:00 [INF] Hosting environment: Development
2020-02-12 16:20:13.919 +08:00 [INF] Content root path: E:\SandTablePriject\.net core3.1\MyAPI\MyAPI
2020-02-12 16:20:21.711 +08:00 [INF] Request starting HTTP/1.1 POST http://localhost:5000/api/User_Meeting application/json 135
2020-02-12 16:20:21.783 +08:00 [INF] CORS policy execution failed.
2020-02-12 16:20:21.784 +08:00 [INF] Request origin http://localhost:4200 does not have permission to access the resource.
2020-02-12 16:20:22.417 +08:00 [INF] Successfully validated the token.
2020-02-12 16:20:22.424 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:20:22.465 +08:00 [INF] Route matched with {action = "Post", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Post(Infrastructure.Dto.User_MeetingInputDto) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:20:30.048 +08:00 [DBG] 开始添加一条中间表信息
2020-02-12 16:20:32.750 +08:00 [DBG] 判断是否存在此条记录
2020-02-12 16:20:33.586 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:20:34.382 +08:00 [INF] Executed DbCommand (71ms) [Parameters=[@__user_Meeting_UserId_0='?' (Size = 450), @__user_Meeting_MeetingId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT CASE
    WHEN EXISTS (
        SELECT 1
        FROM [User_Meeting] AS [u]
        WHERE ([u].[UserId] = @__user_Meeting_UserId_0) AND ([u].[MeetingId] = @__user_Meeting_MeetingId_1)) THEN CAST(1 AS bit)
    ELSE CAST(0 AS bit)
END
2020-02-12 16:20:35.571 +08:00 [DBG] 添加了一条参会记录数据
2020-02-12 16:20:36.572 +08:00 [INF] Executed DbCommand (94ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (Size = 450), @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SET NOCOUNT ON;
INSERT INTO [User_Meeting] ([MeetingId], [UserId], [User_MeetingStats])
VALUES (@p0, @p1, @p2);
SELECT [Id]
FROM [User_Meeting]
WHERE @@ROWCOUNT = 1 AND [Id] = scope_identity();
2020-02-12 16:20:41.589 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.User_MeetingOutputDto'.
2020-02-12 16:20:43.574 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Post (MyAPI) in 21096.5827ms
2020-02-12 16:20:43.578 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Post (MyAPI)'
2020-02-12 16:20:43.589 +08:00 [INF] Request finished in 21883.9627ms 201 application/json; charset=utf-8
2020-02-12 16:20:47.445 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:20:47.454 +08:00 [INF] Successfully validated the token.
2020-02-12 16:20:47.457 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:20:47.469 +08:00 [INF] Route matched with {action = "Get", controller = "Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.MeetingController (MyAPI).
2020-02-12 16:20:47.552 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:20:47.632 +08:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [Meeting] AS [m]
WHERE [m].[UserId] = @__userId_0
2020-02-12 16:20:47.695 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:20:47.710 +08:00 [INF] Executed action MyAPI.Controllers.MeetingController.Get (MyAPI) in 231.0957ms
2020-02-12 16:20:47.712 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.MeetingController.Get (MyAPI)'
2020-02-12 16:20:47.718 +08:00 [INF] Request finished in 273.2774ms 200 application/json; charset=utf-8
2020-02-12 16:20:47.989 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting?userId=2869c3e7-ef9f-4dd8-af3d-2fad8ecb8483  
2020-02-12 16:20:48.030 +08:00 [INF] Successfully validated the token.
2020-02-12 16:20:48.050 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:20:48.063 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(System.String) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:20:48.092 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:20:48.193 +08:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (Size = 450)], CommandType='"Text"', CommandTimeout='30']
SELECT [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
WHERE [u].[UserId] = @__userId_0
2020-02-12 16:20:48.223 +08:00 [INF] Executing ObjectResult, writing value of type 'System.Collections.Generic.List`1[[Infrastructure.Dto.User_MeetingOutputDto, Infrastructure, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2020-02-12 16:20:48.227 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 157.9446ms
2020-02-12 16:20:48.243 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:20:48.269 +08:00 [INF] Request finished in 283.703ms 200 application/json; charset=utf-8
2020-02-12 16:20:51.617 +08:00 [INF] Request starting HTTP/1.1 GET http://localhost:5000/api/User_Meeting/14  
2020-02-12 16:20:51.630 +08:00 [INF] Successfully validated the token.
2020-02-12 16:20:51.631 +08:00 [INF] Executing endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:20:51.645 +08:00 [INF] Route matched with {action = "Get", controller = "User_Meeting"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] Get(Int32) on controller MyAPI.Controllers.User_MeetingController (MyAPI).
2020-02-12 16:20:51.661 +08:00 [INF] Entity Framework Core 3.1.0 initialized 'ApplicationDbContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
2020-02-12 16:20:51.703 +08:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT TOP(1) [u].[Id], [u].[MeetingId], [u].[UserId], [u].[User_MeetingStats], [m].[Id], [m].[Address], [m].[Content], [m].[DateTime], [m].[InviteCode], [m].[MeetingName], [m].[MeetingStats], [m].[UserId], [a].[Id], [a].[AccessFailedCount], [a].[ConcurrencyStamp], [a].[Email], [a].[EmailConfirmed], [a].[LockoutEnabled], [a].[LockoutEnd], [a].[NormalizedEmail], [a].[NormalizedUserName], [a].[PasswordHash], [a].[PhoneNumber], [a].[PhoneNumberConfirmed], [a].[SecurityStamp], [a].[TwoFactorEnabled], [a].[UserName]
FROM [User_Meeting] AS [u]
INNER JOIN [Meeting] AS [m] ON [u].[MeetingId] = [m].[Id]
INNER JOIN [AspNetUsers] AS [a] ON [u].[UserId] = [a].[Id]
WHERE [u].[Id] = @__id_0
2020-02-12 16:20:51.739 +08:00 [INF] Executing ObjectResult, writing value of type 'Infrastructure.Dto.User_MeetingOutputDto'.
2020-02-12 16:20:51.741 +08:00 [INF] Executed action MyAPI.Controllers.User_MeetingController.Get (MyAPI) in 88.8515ms
2020-02-12 16:20:51.744 +08:00 [INF] Executed endpoint 'MyAPI.Controllers.User_MeetingController.Get (MyAPI)'
2020-02-12 16:20:51.749 +08:00 [INF] Request finished in 132.3479ms 200 application/json; charset=utf-8
2020-02-12 17:22:56.898 +08:00 [INF] Application is shutting down...
